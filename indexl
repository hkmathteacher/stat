<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•¸æ“šå°çµ±è¨ˆé‡çš„å½±éŸ¿å±•ç¤º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
            background-color: #f3f4f6;
        }
        .stat-card {
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        input:focus {
            outline: none;
            border-color: #3b82f6;
            ring: 2px;
        }
        canvas {
            touch-action: none;
        }
        /* Toggle Switch Styles */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #2563eb;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #2563eb;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto px-4 py-8 max-w-5xl">
        
        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-blue-800 mb-2">çµ±è¨ˆé‡äº’å‹•å¯¦é©—å®¤</h1>
            <p class="text-gray-600">ä¿®æ”¹æ•¸æ“šï¼Œè§€å¯Ÿå°å¹³å‡æ•¸ã€ä¸­ä½æ•¸ã€æ¨™æº–å·®ç­‰çµ±è¨ˆé‡çš„å½±éŸ¿ã€‚</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- Left Column: Input and Controls -->
            <div class="lg:col-span-1 space-y-6">
                
                <!-- Data Input -->
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <label class="block text-sm font-medium text-gray-700 mb-2">è¼¸å…¥æ•¸æ“š (ä»¥é€—è™Ÿåˆ†éš”):</label>
                    <textarea id="dataInput" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-lg" placeholder="ä¾‹å¦‚: 10, 20, 30...">10, 12, 15, 15, 18, 20, 22</textarea>
                    <div class="mt-2 text-xs text-gray-500 flex justify-between">
                        <span id="countDisplay">æ•¸é‡ n = 7</span>
                        <button onclick="resetData()" class="text-blue-600 hover:text-blue-800 underline">é‡ç½®é è¨­å€¼</button>
                    </div>
                </div>

                <!-- Scenario Buttons -->
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-sm font-bold text-gray-700 uppercase tracking-wider mb-4">å¯¦é©—å ´æ™¯</h3>
                    <div class="space-y-3">
                        <button onclick="shiftData(5)" class="w-full text-left px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition flex items-center group">
                            <span class="bg-blue-200 p-1 rounded mr-3 text-xs group-hover:bg-blue-300">+5</span>
                            <div>
                                <div class="font-semibold">æ•¸æ“šå¹³ç§» (+5)</div>
                                <div class="text-xs text-blue-600 opacity-80">é›†ä¸­è¶¨å‹¢å¢åŠ ï¼Œé›¢å·®(SD/IQR)ä¸è®Š</div>
                            </div>
                        </button>

                        <button onclick="multiplyData(2)" class="w-full text-left px-4 py-3 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition flex items-center group">
                            <span class="bg-purple-200 p-1 rounded mr-3 text-xs group-hover:bg-purple-300">x2</span>
                            <div>
                                <div class="font-semibold">æ•¸æ“šå€å¢ (x2)</div>
                                <div class="text-xs text-purple-600 opacity-80">æ‰€æœ‰æ•¸å€¼è®Šå¤§ï¼Œåˆ†ä½ˆè®Šå¯¬ (SDè®Šå¤§)</div>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- Legend for Dot Plot -->
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-sm font-bold text-gray-700 uppercase tracking-wider mb-3">åœ–ä¾‹èªªæ˜</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-center">
                            <div class="w-3 h-3 rounded-full bg-blue-500 mr-2"></div>
                            <span>æ•¸æ“šé» (Dot)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-1 bg-emerald-500 mr-2"></div>
                            <span>ä¸­ä½æ•¸ (Median)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-1 bg-gray-400 mr-2"></div>
                            <span>å››åˆ†ä½æ•¸é–“è· (IQR)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Visualization and Stats -->
            <div class="lg:col-span-2 space-y-6">
                
                <!-- Dot Plot Canvas Area (New) -->
                <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-500">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">æ•¸ç·šåˆ†æ (Dot Plot)</h3>
                            <p class="text-xs text-gray-500">
                                é–å®šæ•¸ç·šå¾Œé€²è¡Œå¹³ç§»ï¼Œå¯è§€å¯Ÿæ•¸æ“šæ•´é«”ç§»å‹•ã€‚
                            </p>
                        </div>
                        
                        <!-- Toggle Switch -->
                        <div class="flex items-center bg-gray-50 p-2 rounded-lg border border-gray-200">
                            <span class="text-sm text-gray-600 mr-3 font-medium" id="lockLabel">è‡ªå‹•ç¸®æ”¾</span>
                            <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                                <input type="checkbox" name="toggle" id="axisLockToggle" onchange="toggleAxisLock()" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-300 ease-in-out border-gray-300 left-0"/>
                                <label for="axisLockToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                            </div>
                            <button onclick="resetAxis()" id="resetAxisBtn" class="hidden text-xs bg-white hover:bg-gray-100 text-blue-600 px-2 py-1 rounded border border-blue-200 shadow-sm ml-2">
                                é‡ç½®è¦–åœ–
                            </button>
                        </div>
                    </div>

                    <div class="relative w-full h-48">
                        <canvas id="dotPlotCanvas" class="w-full h-full"></canvas>
                    </div>
                </div>

                <!-- Histogram Area -->
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">é »æ•¸åˆ†ä½ˆ (Histogram)</h3>
                    <div class="relative h-48 w-full">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <!-- Mean -->
                    <div class="stat-card bg-blue-600 text-white p-4 rounded-xl shadow-lg relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-4 opacity-10 text-4xl font-black">Î¼</div>
                        <h4 class="text-blue-100 text-sm font-medium">å¹³å‡æ•¸ (Mean)</h4>
                        <div id="valMean" class="text-3xl font-bold mt-1">-</div>
                        <p class="text-xs text-blue-200 mt-2">æ˜“å—æ¥µç«¯å€¼å½±éŸ¿</p>
                    </div>

                    <!-- Median -->
                    <div class="stat-card bg-emerald-500 text-white p-4 rounded-xl shadow-lg relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-4 opacity-10 text-4xl font-black">M</div>
                        <h4 class="text-emerald-100 text-sm font-medium">ä¸­ä½æ•¸ (Median)</h4>
                        <div id="valMedian" class="text-3xl font-bold mt-1">-</div>
                        <p class="text-xs text-emerald-100 mt-2">è¼ƒç©©å¥çš„ä¸­å¿ƒæŒ‡æ¨™</p>
                    </div>

                    <!-- Mode -->
                    <div class="stat-card bg-purple-500 text-white p-4 rounded-xl shadow-lg relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-4 opacity-10 text-4xl font-black">Mo</div>
                        <h4 class="text-purple-100 text-sm font-medium">çœ¾æ•¸ (Mode)</h4>
                        <div id="valMode" class="text-2xl font-bold mt-1">-</div>
                        <p class="text-xs text-purple-200 mt-2">å‡ºç¾æœ€é »ç¹çš„æ•¸</p>
                    </div>

                    <!-- Range -->
                    <div class="stat-card bg-white p-4 rounded-xl shadow border border-gray-200">
                        <h4 class="text-gray-500 text-xs font-bold uppercase">åˆ†ä½ˆåŸŸ (Range)</h4>
                        <div id="valRange" class="text-2xl font-bold text-gray-800 mt-1">-</div>
                        <div class="text-xs text-gray-400 mt-1">æœ€å¤§å€¼ - æœ€å°å€¼</div>
                    </div>

                    <!-- IQR -->
                    <div class="stat-card bg-white p-4 rounded-xl shadow border border-gray-200">
                        <h4 class="text-gray-500 text-xs font-bold uppercase">å››åˆ†ä½æ•¸é–“è· (IQR)</h4>
                        <div id="valIQR" class="text-2xl font-bold text-gray-800 mt-1">-</div>
                        <div class="text-xs text-gray-400 mt-1">Q3 - Q1 (ä¸­é–“50%æ•¸æ“š)</div>
                    </div>

                    <!-- SD & Variance Group -->
                    <div class="stat-card bg-orange-50 p-4 rounded-xl shadow border border-orange-100 col-span-2 md:col-span-1">
                        <h4 class="text-orange-800 text-xs font-bold uppercase mb-1">é›¢æ•£ç¨‹åº¦</h4>
                        <div class="flex flex-col gap-2">
                            <div>
                                <span class="text-xs text-gray-500">æ¨™æº–å·® (SD, Ïƒ):</span>
                                <span id="valSD" class="font-bold text-orange-700 text-lg ml-1">-</span>
                            </div>
                            <div>
                                <span class="text-xs text-gray-500">æ–¹å·® (Variance, ÏƒÂ²):</span>
                                <span id="valVar" class="font-bold text-orange-700 text-lg ml-1">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Explanation Section -->
        <div class="mt-8 bg-blue-50 border border-blue-100 rounded-xl p-6">
            <h3 class="text-lg font-bold text-blue-900 mb-2">ğŸ’¡ è§€å¯Ÿé‡é»</h3>
            <ul class="list-disc list-inside text-blue-800 space-y-1 text-sm">
                <li><strong>åˆ©ç”¨é–å®šåŠŸèƒ½</strong>ï¼šé–‹å•Ÿã€Œé–å®šåº§æ¨™è»¸ã€ï¼Œç„¶å¾Œé»æ“Šã€Œæ•¸æ“šå¹³ç§» (+5)ã€ã€‚ä½ æœƒç™¼ç¾æ‰€æœ‰é»ä¸€èµ·å‘å³ç§»å‹•ï¼Œå°±åƒä¸€è¼›ç«è»Šï¼Œè»Šå»‚ä¹‹é–“çš„è·é›¢ï¼ˆé›¢æ•£ç¨‹åº¦ï¼‰å®Œå…¨æ²’æœ‰æ”¹è®Šã€‚</li>
                <li><strong>å››åˆ†ä½æ•¸é–“è· (IQR)</strong>ï¼šç°è‰²ç·šæ®µä»£è¡¨ä¸­é–“ 50% æ•¸æ“šçš„ç¯„åœ (Q1 åˆ° Q3)ã€‚é€™æ®µé•·åº¦ç›´è§€åœ°é¡¯ç¤ºäº†æ•¸æ“šä¸­é–“éƒ¨åˆ†çš„é›†ä¸­ç¨‹åº¦ã€‚</li>
            </ul>
        </div>
    </div>

    <script>
        // --- State ---
        let chartInstance = null;
        const defaultData = "10, 12, 15, 15, 18, 20, 22";
        
        // Axis Locking State
        let isAxisLocked = false;
        let lockedMin = 0;
        let lockedMax = 100;

        // --- DOM Elements ---
        const inputEl = document.getElementById('dataInput');
        const countEl = document.getElementById('countDisplay');

        // Stats Elements
        const els = {
            mean: document.getElementById('valMean'),
            median: document.getElementById('valMedian'),
            mode: document.getElementById('valMode'),
            range: document.getElementById('valRange'),
            iqr: document.getElementById('valIQR'),
            sd: document.getElementById('valSD'),
            variance: document.getElementById('valVar')
        };

        // --- Event Listeners ---
        inputEl.addEventListener('input', calculateAndRender);
        window.addEventListener('resize', calculateAndRender); // Re-render canvas on resize
        
        // --- Initialization ---
        window.onload = () => {
            calculateAndRender();
        };

        // --- Core Logic ---

        function getNumbers() {
            const raw = inputEl.value;
            const nums = raw.split(/[\s,]+/)
                           .filter(s => s.trim() !== '' && !isNaN(Number(s)))
                           .map(Number);
            return nums.sort((a, b) => a - b);
        }

        function calculateAndRender() {
            const nums = getNumbers();
            
            countEl.textContent = `æ•¸é‡ n = ${nums.length}`;

            if (nums.length === 0) {
                Object.values(els).forEach(el => el.textContent = "-");
                updateChart([]);
                drawDotPlot([], {});
                return;
            }

            const stats = calculateStats(nums);

            // Render Stats Text
            els.mean.textContent = round(stats.mean);
            els.median.textContent = round(stats.median);
            els.mode.textContent = stats.mode.join(', ') || 'ç„¡';
            els.range.textContent = round(stats.range);
            els.iqr.textContent = round(stats.iqr);
            els.sd.textContent = round(stats.sd);
            els.variance.textContent = round(stats.variance);

            // Visualizations
            updateChart(nums);
            drawDotPlot(nums, stats);
        }

        function calculateStats(arr) {
            const n = arr.length;
            const sum = arr.reduce((a, b) => a + b, 0);
            const mean = sum / n;

            // Median
            let median;
            const mid = Math.floor(n / 2);
            if (n % 2 !== 0) {
                median = arr[mid];
            } else {
                median = (arr[mid - 1] + arr[mid]) / 2;
            }

            // Mode
            const counts = {};
            let maxFreq = 0;
            arr.forEach(num => {
                counts[num] = (counts[num] || 0) + 1;
                if (counts[num] > maxFreq) maxFreq = counts[num];
            });
            let modes = [];
            if (maxFreq > 1) { 
                if (maxFreq === 1 && n > 1) {
                    modes = ["ç„¡"];
                } else {
                    for (const num in counts) {
                        if (counts[num] === maxFreq) modes.push(num);
                    }
                }
            } else {
                 modes = n === 1 ? [arr[0]] : ["ç„¡"];
            }

            // Range
            const range = arr[n - 1] - arr[0];

            // SD & Variance
            const variance = arr.reduce((acc, val) => acc + Math.pow(val - mean, 2), 0) / n;
            const sd = Math.sqrt(variance);

            // IQR
            let lowerHalf = [];
            let upperHalf = [];
            if (n % 2 === 0) {
                lowerHalf = arr.slice(0, mid);
                upperHalf = arr.slice(mid);
            } else {
                lowerHalf = arr.slice(0, mid);
                upperHalf = arr.slice(mid + 1);
            }
            const q1 = getMedian(lowerHalf);
            const q3 = getMedian(upperHalf);
            const iqr = q3 - q1;

            return { mean, median, mode: modes, range, variance, sd, iqr, q1, q3, min: arr[0], max: arr[n-1] };
        }

        function getMedian(arr) {
            if (arr.length === 0) return 0;
            const mid = Math.floor(arr.length / 2);
            if (arr.length % 2 !== 0) return arr[mid];
            return (arr[mid - 1] + arr[mid]) / 2;
        }

        function round(num) {
            return Math.round(num * 100) / 100;
        }

        // --- Chart.js Histogram ---
        function updateChart(nums) {
            const ctx = document.getElementById('myChart').getContext('2d');
            const freqMap = {};
            nums.forEach(n => freqMap[n] = (freqMap[n] || 0) + 1);
            const labels = Object.keys(freqMap).map(Number).sort((a,b) => a-b);
            const data = labels.map(l => freqMap[l]);

            if (chartInstance) {
                chartInstance.destroy();
            }

            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'é »æ•¸',
                        data: data,
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgb(59, 130, 246)',
                        borderWidth: 1,
                        barPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1 }, display: false },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // --- Axis Lock Logic ---
        function toggleAxisLock() {
            const checkbox = document.getElementById('axisLockToggle');
            const label = document.getElementById('lockLabel');
            const resetBtn = document.getElementById('resetAxisBtn');

            isAxisLocked = checkbox.checked;

            if (isAxisLocked) {
                // Lock Logic
                label.textContent = "å·²é–å®šåº§æ¨™è»¸ (0-100)";
                label.classList.add('text-blue-700', 'font-bold');
                resetBtn.classList.remove('hidden');

                // Set fixed range 0-100 as requested
                lockedMin = 0;
                lockedMax = 100;
            } else {
                // Unlock
                label.textContent = "è‡ªå‹•ç¸®æ”¾";
                label.classList.remove('text-blue-700', 'font-bold');
                resetBtn.classList.add('hidden');
            }
            calculateAndRender();
        }

        function resetAxis() {
            document.getElementById('axisLockToggle').checked = false;
            toggleAxisLock();
        }

        // --- Custom Dot Plot & Number Line Logic ---
        function drawDotPlot(nums, stats) {
            const canvas = document.getElementById('dotPlotCanvas');
            const ctx = canvas.getContext('2d');
            
            // Handle high DPI displays
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);

            ctx.clearRect(0, 0, rect.width, rect.height);

            if (nums.length === 0) return;

            // Dimensions
            const w = rect.width;
            const h = rect.height;
            const padding = 40;
            const bottomMargin = 40;
            
            // Calculate Scale Range
            let minVal, maxVal;

            if (isAxisLocked) {
                minVal = lockedMin;
                maxVal = lockedMax;
            } else {
                // Auto Scale Logic
                minVal = stats.min;
                maxVal = stats.max;
                let range = maxVal - minVal;
                
                if (range === 0) {
                    minVal -= 5;
                    maxVal += 5;
                } else {
                    const buffer = range * 0.15;
                    minVal -= buffer;
                    maxVal += buffer;
                }
            }
            
            let range = maxVal - minVal;
            if (range <= 0) range = 10; // Safety

            const getX = (val) => {
                return padding + ((val - minVal) / range) * (w - 2 * padding);
            };

            // --- Draw Background Grid / Ticks ---
            // Determine nice step size
            const rawStep = range / 10;
            // Find magnitude of step (e.g., 0.1, 1, 10, 100)
            const magnitude = Math.pow(10, Math.floor(Math.log10(rawStep)));
            // Normalize step to 1, 2, or 5 times magnitude
            let stepSize;
            if (rawStep / magnitude < 2) stepSize = magnitude;
            else if (rawStep / magnitude < 5) stepSize = 2 * magnitude;
            else stepSize = 5 * magnitude;
            
            // Draw grid lines
            ctx.strokeStyle = "#e5e7eb"; // Light gray grid
            ctx.lineWidth = 1;
            ctx.font = "10px sans-serif";
            ctx.fillStyle = "#9ca3af";
            ctx.textAlign = "center";

            const startTick = Math.ceil(minVal / stepSize) * stepSize;
            for (let v = startTick; v <= maxVal; v += stepSize) {
                const x = getX(v);
                if (x < padding || x > w - padding) continue;
                
                // Vertical grid line (optional, maybe just ticks)
                ctx.beginPath();
                ctx.moveTo(x, 20);
                ctx.lineTo(x, h - bottomMargin);
                ctx.stroke();

                // Axis Tick text
                ctx.fillText(Math.round(v * 100) / 100, x, h - bottomMargin + 15);
            }

            // [REMOVED] 1. Draw SD Range
            // [REMOVED] SD Area drawing code block deleted.

            // 2. Draw IQR Line
            const q1X = getX(stats.q1);
            const q3X = getX(stats.q3);
            const iqrY = h - bottomMargin + 25; // Moved down slightly
            
            // Only draw if within reasonable bounds (clipping simplified)
            if (q3X > padding && q1X < w - padding) {
                ctx.beginPath();
                ctx.strokeStyle = "#9ca3af"; 
                ctx.lineWidth = 3;
                // Simple clamp for drawing
                ctx.moveTo(Math.max(padding, q1X), iqrY);
                ctx.lineTo(Math.min(w-padding, q3X), iqrY);
                ctx.stroke();
                
                // Caps
                if (q1X >= padding && q1X <= w-padding) {
                     ctx.beginPath(); ctx.moveTo(q1X, iqrY-4); ctx.lineTo(q1X, iqrY+4); ctx.stroke();
                }
                if (q3X >= padding && q3X <= w-padding) {
                     ctx.beginPath(); ctx.moveTo(q3X, iqrY-4); ctx.lineTo(q3X, iqrY+4); ctx.stroke();
                }
            }


            // 3. Draw Axis Line (Main baseline)
            const axisY = h - bottomMargin;
            ctx.beginPath();
            ctx.strokeStyle = "#374151"; 
            ctx.lineWidth = 2;
            ctx.moveTo(padding, axisY);
            ctx.lineTo(w - padding, axisY);
            ctx.stroke();

            // [REMOVED] 4. Draw Mean Line
            // [REMOVED] Mean Line drawing code block deleted.

            // 5. Draw Median Line
            const medianX = getX(stats.median);
            if (medianX >= padding && medianX <= w - padding) {
                ctx.beginPath();
                ctx.strokeStyle = "#10b981"; 
                ctx.lineWidth = 2;
                ctx.moveTo(medianX, 20);
                ctx.lineTo(medianX, axisY + 5);
                ctx.stroke();
                
                ctx.fillStyle = "#10b981";
                ctx.font = "bold 12px sans-serif";
                ctx.fillText("M", medianX, 15);
            }

            // 6. Draw Dots (Data Points)
            const dotRadius = 5;
            const counts = {}; 
            
            ctx.fillStyle = "rgba(59, 130, 246, 0.8)";
            
            // Render Dots
            nums.forEach(num => {
                const x = getX(num);
                // Check if visible
                if (x < padding - dotRadius || x > w - padding + dotRadius) {
                    return; 
                }

                const stackIndex = counts[num] || 0;
                counts[num] = stackIndex + 1;
                
                const y = axisY - 10 - (stackIndex * (dotRadius * 2 + 2)); 
                
                ctx.beginPath();
                ctx.arc(x, y, dotRadius, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Out of bounds warning
            if (stats.min < minVal || stats.max > maxVal) {
                ctx.fillStyle = "red";
                ctx.font = "bold 12px sans-serif";
                ctx.textAlign = "right";
                ctx.fillText("âš ï¸ éƒ¨åˆ†æ•¸æ“šåœ¨è¦–åœ–å¤–", w - padding, 30);
            }
        }

        // --- Scenario Functions ---
        function resetData() {
            inputEl.value = defaultData;
            calculateAndRender();
            flashInput();
        }

        function shiftData(amount) {
            let nums = getNumbers();
            nums = nums.map(n => n + amount);
            inputEl.value = nums.join(', ');
            calculateAndRender();
            flashInput();
        }

        function multiplyData(factor) {
            let nums = getNumbers();
            nums = nums.map(n => n * factor);
            inputEl.value = nums.join(', ');
            calculateAndRender();
            flashInput();
        }

        function flashInput() {
            inputEl.classList.add('bg-yellow-100');
            setTimeout(() => inputEl.classList.remove('bg-yellow-100'), 300);
        }
    </script>
</body>
</html>
